<script>export let label = "";
export let value = void 0;
export let min = 0;
export let max = 100;
export let height = "h-2";
export let rounded = "rounded-token";
export let meter = "bg-secondary-500";
export let track = "bg-surface-200-700-token";
const cBase = "w-full";
const cBaseLabel = "block text-sm mb-2";
const cBaseTrack = `w-full overflow-hidden`;
const cBaseMeterDeterminate = "h-full";
const cBaseMeterIndeterminate = "h-full w-full";
$:
  fillPercent = value ? 100 * (value - min) / (max - min) : 0;
$:
  classesTrack = `${cBaseTrack} ${height} ${rounded} ${track} ${$$props.class ?? ""}`;
$:
  classesMeter = `${rounded} ${meter}`;
</script>

<div
	class="progress-bar {cBase}"
	data-testid="progress-bar"
	role="progressbar"
	aria-label={label}
	aria-valuenow={value}
	aria-valuemin={min}
	aria-valuemax={max - min}
>
	<!-- Label -->
	{#if label}<label for="progress" class="progress-bar-label {cBaseLabel}">{label}</label>{/if}
	<!-- Track -->
	<div class="progress-bar-track {classesTrack}">
		<!-- Meter - Determinate / Indeterminate -->
		{#if value !== undefined && value >= 0}
			<div class="progress-bar-meter {cBaseMeterDeterminate} {classesMeter}" style:width="{fillPercent}%" />
		{:else}
			<div class="progress-bar-meter {cBaseMeterIndeterminate} {classesMeter} animIndeterminate" />
		{/if}
	</div>
</div>

<style>
	.animIndeterminate {
		transform-origin: 0% 50%;
		animation: animIndeterminate 2s infinite linear;
	}
	/* prettier-ignore */
	@keyframes animIndeterminate {
		0% { transform: translateX(0) scaleX(0); }
		40% { transform: translateX(0) scaleX(0.4); }
		100% { transform: translateX(100%) scaleX(0.5); }
	}
</style>
